name: PR Size Check

on:
  pull_request:

jobs:
  check-size:
    runs-on: ubuntu-latest 
    env:
      MAX_LINES: 500
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Check PR size
        run: |
          git fetch origin ${{ github.base_ref }}
          CHANGED_LINES=$(git diff --shortstat origin/${{ github.base_ref }}...HEAD | awk '{print $4+$6}')
          echo "Changed lines: ${CHANGED_LINES:-0}"
          echo "Maximum allowed: $MAX_LINES"
          if [ "${CHANGED_LINES:-0}" -gt "$MAX_LINES" ]; then
            echo "::error::PR is too large ($CHANGED_LINES lines). Max: $MAX_LINES lines."
            exit 1
          fi
