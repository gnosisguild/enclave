(function(){"use strict";let i;const l=new Array(128).fill(void 0);l.push(void 0,null,!0,!1);function _(e){return l[e]}let h=l.length;function W(e){e<132||(l[e]=h,h=e)}function v(e){const n=_(e);return W(e),n}const M=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&M.decode();let k=null;function m(){return(k===null||k.byteLength===0)&&(k=new Uint8Array(i.memory.buffer)),k}function d(e,n){return e=e>>>0,M.decode(m().subarray(e,e+n))}function c(e){h===l.length&&l.push(l.length+1);const n=h;return h=l[n],l[n]=e,n}let g=0;const I=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},D=typeof I.encodeInto=="function"?function(e,n){return I.encodeInto(e,n)}:function(e,n){const t=I.encode(e);return n.set(t),{read:e.length,written:t.length}};function y(e,n,t){if(t===void 0){const u=I.encode(e),f=n(u.length,1)>>>0;return m().subarray(f,f+u.length).set(u),g=u.length,f}let r=e.length,o=n(r,1)>>>0;const s=m();let b=0;for(;b<r;b++){const u=e.charCodeAt(b);if(u>127)break;s[o+b]=u}if(b!==r){b!==0&&(e=e.slice(b)),o=t(o,r,r=b+e.length*3,1)>>>0;const u=m().subarray(o+b,o+r),f=D(e,u);b+=f.written,o=t(o,r,b,1)>>>0}return g=b,o}function E(e){return e==null}let p=null;function a(){return(p===null||p.buffer.detached===!0||p.buffer.detached===void 0&&p.buffer!==i.memory.buffer)&&(p=new DataView(i.memory.buffer)),p}function R(e){const n=typeof e;if(n=="number"||n=="boolean"||e==null)return`${e}`;if(n=="string")return`"${e}"`;if(n=="symbol"){const o=e.description;return o==null?"Symbol":`Symbol(${o})`}if(n=="function"){const o=e.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(e)){const o=e.length;let s="[";o>0&&(s+=R(e[0]));for(let b=1;b<o;b++)s+=", "+R(e[b]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(t.length>1)r=t[1];else return toString.call(e);if(r=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:r}const O=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>{i.__wbindgen_export_2.get(e.dtor)(e.a,e.b)});function U(e,n,t,r){const o={a:e,b:n,cnt:1,dtor:t},s=(...b)=>{o.cnt++;const u=o.a;o.a=0;try{return r(u,o.b,...b)}finally{--o.cnt===0?(i.__wbindgen_export_2.get(o.dtor)(u,o.b),O.unregister(o)):o.a=u}};return s.original=o,O.register(s,o,o),s}function C(e,n,t){i._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__he113566e5555d502(e,n,c(t))}function z(e,n){const t=n(e.length*1,1)>>>0;return m().set(e,t/1),g=e.length,t}function q(e,n){return e=e>>>0,m().subarray(e/1,e/1+n)}function V(e,n){i.wasm_bindgen__convert__closures__invoke0_mut__ha21cbda765bd45f6(e,n)}function w(e,n){try{return e.apply(this,n)}catch(t){i.__wbindgen_exn_store(c(t))}}function $(e,n,t,r,o){i.wasm_bindgen__convert__closures__invoke3_mut__h0a13f5b0b2f359e6(e,n,c(t),r,c(o))}function L(e,n,t,r){i.wasm_bindgen__convert__closures__invoke2_mut__hbbd268dd51530abf(e,n,c(t),c(r))}const j=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>i.__wbg_encrypt_free(e>>>0,1));class N{__destroy_into_raw(){const n=this.__wbg_ptr;return this.__wbg_ptr=0,j.unregister(this),n}free(){const n=this.__destroy_into_raw();i.__wbg_encrypt_free(n,0)}constructor(){const n=i.encrypt_new();return this.__wbg_ptr=n>>>0,j.register(this,this.__wbg_ptr,this),this}encrypt_vote(n,t){try{const f=i.__wbindgen_add_to_stack_pointer(-16),A=z(t,i.__wbindgen_malloc),H=g;i.encrypt_encrypt_vote(f,this.__wbg_ptr,n,A,H);var r=a().getInt32(f+4*0,!0),o=a().getInt32(f+4*1,!0),s=a().getInt32(f+4*2,!0),b=a().getInt32(f+4*3,!0);if(b)throw v(s);var u=q(r,o).slice();return i.__wbindgen_free(r,o*1,1),u}finally{i.__wbindgen_add_to_stack_pointer(16)}}static test(){i.encrypt_test()}}typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>i.__wbg_wasmbindgentestcontext_free(e>>>0,1));async function B(e,n){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,n)}catch(r){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await e.arrayBuffer();return await WebAssembly.instantiate(t,n)}else{const t=await WebAssembly.instantiate(e,n);return t instanceof WebAssembly.Instance?{instance:t,module:e}:t}}function P(){const e={};return e.wbg={},e.wbg.__wbindgen_object_drop_ref=function(n){v(n)},e.wbg.__wbindgen_string_new=function(n,t){const r=d(n,t);return c(r)},e.wbg.__wbg_log_4c6146472facbfaa=function(n,t){console.log(d(n,t))},e.wbg.__wbg_String_e73d90ae9c871912=function(n,t){const r=String(_(t)),o=y(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=g;a().setInt32(n+4*1,s,!0),a().setInt32(n+4*0,o,!0)},e.wbg.__wbg_getElementById_8e651e19b1db8af4=function(n,t,r){const o=_(n).getElementById(d(t,r));return c(o)},e.wbg.__wbg_settextcontent_f5ce03c2d5452fdb=function(n,t,r){_(n).textContent=d(t,r)},e.wbg.__wbindgen_string_get=function(n,t){const r=_(t),o=typeof r=="string"?r:void 0;var s=E(o)?0:y(o,i.__wbindgen_malloc,i.__wbindgen_realloc),b=g;a().setInt32(n+4*1,b,!0),a().setInt32(n+4*0,s,!0)},e.wbg.__wbindgen_number_new=function(n){return c(n)},e.wbg.__wbg_wbgtestinvoke_a9c01fbf474f5d4b=function(){return w(function(n,t){try{var r={a:n,b:t},o=()=>{const s=r.a;r.a=0;try{return V(s,r.b)}finally{r.a=s}};__wbg_test_invoke(o)}finally{r.a=r.b=0}},arguments)},e.wbg.__wbg_wbgtestoutputwriteln_af26aa5032b93b71=function(n){__wbg_test_output_writeln(v(n))},e.wbg.__wbindgen_object_clone_ref=function(n){const t=_(n);return c(t)},e.wbg.__wbg_stack_0cf5246a8b98a5c3=function(n){const t=_(n).stack;return c(t)},e.wbg.__wbg_self_91e88697873c977b=function(n){const t=_(n).self;return E(t)?0:c(t)},e.wbg.__wbg_constructor_2aca75e2f55853d3=function(n){const t=_(n).constructor;return c(t)},e.wbg.__wbg_name_8e788143eb60943f=function(n,t){const r=_(t).name,o=y(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=g;a().setInt32(n+4*1,s,!0),a().setInt32(n+4*0,o,!0)},e.wbg.__wbg_Deno_5db6104106b466fc=function(n){const t=_(n).Deno;return E(t)?0:c(t)},e.wbg.__wbg_stack_b73d0c34f7b4416b=function(n,t){const r=_(t).stack,o=y(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=g;a().setInt32(n+4*1,s,!0),a().setInt32(n+4*0,o,!0)},e.wbg.__wbg_static_accessor_DOCUMENT_c9d3ded98505f352=function(){return c(document)},e.wbg.__wbg_textcontent_9f35c3e14d1b1ad8=function(n,t){const r=_(t).textContent,o=y(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=g;a().setInt32(n+4*1,s,!0),a().setInt32(n+4*0,o,!0)},e.wbg.__wbg_stack_b18cfcfd5aef8d27=function(n){const t=_(n).stack;return c(t)},e.wbg.__wbg_new_abda76e883ba8a5f=function(){const n=new Error;return c(n)},e.wbg.__wbg_stack_658279fe44541cf6=function(n,t){const r=_(t).stack,o=y(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=g;a().setInt32(n+4*1,s,!0),a().setInt32(n+4*0,o,!0)},e.wbg.__wbg_error_f851667af71bcfc6=function(n,t){let r,o;try{r=n,o=t,console.error(d(n,t))}finally{i.__wbindgen_free(r,o,1)}},e.wbg.__wbg_queueMicrotask_48421b3cc9052b68=function(n){const t=_(n).queueMicrotask;return c(t)},e.wbg.__wbindgen_is_function=function(n){return typeof _(n)=="function"},e.wbg.__wbindgen_cb_drop=function(n){const t=v(n).original;return t.cnt--==1?(t.a=0,!0):!1},e.wbg.__wbg_queueMicrotask_12a30234db4045d3=function(n){queueMicrotask(_(n))},e.wbg.__wbg_debug_5fb96680aecf5dc8=function(n){console.debug(_(n))},e.wbg.__wbg_error_8e3928cfb8a43e2b=function(n){console.error(_(n))},e.wbg.__wbg_info_530a29cb2e4e3304=function(n){console.info(_(n))},e.wbg.__wbg_log_5bb5f88f245d7762=function(n){console.log(_(n))},e.wbg.__wbg_warn_63bbae1730aead09=function(n){console.warn(_(n))},e.wbg.__wbg_crypto_566d7465cdbb6b7a=function(n){const t=_(n).crypto;return c(t)},e.wbg.__wbindgen_is_object=function(n){const t=_(n);return typeof t=="object"&&t!==null},e.wbg.__wbg_process_dc09a8c7d59982f6=function(n){const t=_(n).process;return c(t)},e.wbg.__wbg_versions_d98c6400c6ca2bd8=function(n){const t=_(n).versions;return c(t)},e.wbg.__wbg_node_caaf83d002149bd5=function(n){const t=_(n).node;return c(t)},e.wbg.__wbindgen_is_string=function(n){return typeof _(n)=="string"},e.wbg.__wbg_require_94a9da52636aacbf=function(){return w(function(){const n=module.require;return c(n)},arguments)},e.wbg.__wbg_msCrypto_0b84745e9245cdf6=function(n){const t=_(n).msCrypto;return c(t)},e.wbg.__wbg_randomFillSync_290977693942bf03=function(){return w(function(n,t){_(n).randomFillSync(v(t))},arguments)},e.wbg.__wbg_getRandomValues_260cc23a41afad9a=function(){return w(function(n,t){_(n).getRandomValues(_(t))},arguments)},e.wbg.__wbg_newnoargs_76313bd6ff35d0f2=function(n,t){const r=new Function(d(n,t));return c(r)},e.wbg.__wbg_call_1084a111329e68ce=function(){return w(function(n,t){const r=_(n).call(_(t));return c(r)},arguments)},e.wbg.__wbg_self_3093d5d1f7bcb682=function(){return w(function(){const n=self.self;return c(n)},arguments)},e.wbg.__wbg_window_3bcfc4d31bc012f8=function(){return w(function(){const n=window.window;return c(n)},arguments)},e.wbg.__wbg_globalThis_86b222e13bdf32ed=function(){return w(function(){const n=globalThis.globalThis;return c(n)},arguments)},e.wbg.__wbg_global_e5a3fe56f8be9485=function(){return w(function(){const n=globalThis.global;return c(n)},arguments)},e.wbg.__wbindgen_is_undefined=function(n){return _(n)===void 0},e.wbg.__wbg_forEach_1778105a4f7c1a63=function(n,t,r){try{var o={a:t,b:r},s=(b,u,f)=>{const A=o.a;o.a=0;try{return $(A,o.b,b,u,f)}finally{o.a=A}};_(n).forEach(s)}finally{o.a=o.b=0}},e.wbg.__wbg_message_e18bae0a0e2c097a=function(n){const t=_(n).message;return c(t)},e.wbg.__wbg_name_ac78212e803c7941=function(n){const t=_(n).name;return c(t)},e.wbg.__wbg_call_89af060b4e1523f2=function(){return w(function(n,t,r){const o=_(n).call(_(t),_(r));return c(o)},arguments)},e.wbg.__wbg_new_b85e72ed1bfd57f9=function(n,t){try{var r={a:n,b:t},o=(b,u)=>{const f=r.a;r.a=0;try{return L(f,r.b,b,u)}finally{r.a=f}};const s=new Promise(o);return c(s)}finally{r.a=r.b=0}},e.wbg.__wbg_resolve_570458cb99d56a43=function(n){const t=Promise.resolve(_(n));return c(t)},e.wbg.__wbg_then_95e6edc0f89b73b1=function(n,t){const r=_(n).then(_(t));return c(r)},e.wbg.__wbg_buffer_b7b08af79b0b0974=function(n){const t=_(n).buffer;return c(t)},e.wbg.__wbg_newwithbyteoffsetandlength_8a2cb9ca96b27ec9=function(n,t,r){const o=new Uint8Array(_(n),t>>>0,r>>>0);return c(o)},e.wbg.__wbg_new_ea1883e1e5e86686=function(n){const t=new Uint8Array(_(n));return c(t)},e.wbg.__wbg_set_d1e79e2388520f18=function(n,t,r){_(n).set(_(t),r>>>0)},e.wbg.__wbg_newwithlength_ec548f448387c968=function(n){const t=new Uint8Array(n>>>0);return c(t)},e.wbg.__wbg_subarray_7c2e3576afe181d1=function(n,t,r){const o=_(n).subarray(t>>>0,r>>>0);return c(o)},e.wbg.__wbindgen_debug_string=function(n,t){const r=R(_(t)),o=y(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=g;a().setInt32(n+4*1,s,!0),a().setInt32(n+4*0,o,!0)},e.wbg.__wbindgen_throw=function(n,t){throw new Error(d(n,t))},e.wbg.__wbindgen_memory=function(){const n=i.memory;return c(n)},e.wbg.__wbindgen_closure_wrapper268=function(n,t,r){const o=U(n,t,82,C);return c(o)},e}function G(e,n){return i=e.exports,x.__wbindgen_wasm_module=n,p=null,k=null,i}async function x(e){if(i!==void 0)return i;typeof e<"u"&&Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead"),typeof e>"u"&&(e=new URL("/assets/crisp_web_bg-DGyV2nkc.wasm",self.location.href));const n=P();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:r}=await B(await e,n);return G(t,r)}let S=null,T=null;async function F(){S||(S=await x(),T=new N)}F(),self.onmessage=async function(e){const{type:n,data:t}=e.data;switch(n){case"encrypt_vote":try{const{voteId:r,publicKey:o}=t;(!S||!T)&&await F();const s=T.encrypt_vote(r,o);self.postMessage({type:"encrypt_vote",success:!0,encryptedVote:s})}catch(r){self.postMessage({type:"encrypt_vote",success:!1,error:r.message})}break;default:console.error(`Unknown message type: ${n}`)}}})();
