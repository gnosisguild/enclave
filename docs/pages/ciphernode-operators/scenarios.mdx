---
title: 'Runbook Scenarios'
---

# Runbook Scenarios

Borrowed from incident playbooks across Ritual/Fhenix-style docs, these scenarios show how to apply
Enclave operator procedures under real conditions.

## Scenario 1 — New operator onboarding

1. Follow [Registration & Licensing](./registration) to bond ENCL and mint tickets.
2. Use `enclave config-set` with production RPC URLs and bootstrap peers.
3. Dry-run `enclave nodes up` against Sepolia before pointing at mainnet.
4. Set alerts for `isActive` changes and missed sortition submissions.

## Scenario 2 — Ticket rebalance before a major request

1. Check `BondingRegistry.ticketPrice()` and current balances.
2. Approve + add tickets at least one block before the anticipated request.
3. Verify snapshots with `bondingRegistry.availableTickets(operator)`.
4. Confirm the CLI logs show `sortition::submitted` for the new ticket numbers.

## Scenario 3 — Handling a slashing proposal

1. Fetch the policy via `SlashingManager.reasonPolicies(reason)`.
2. Gather logs around the alleged offense (sortition miss, share mismatch, etc.).
3. File `fileAppeal` if the policy's `requiresProof` is false and `appealWindow > 0`.
4. Increase monitoring frequency to avoid cascading penalties.

## Scenario 4 — Planned maintenance / temporary exit

1. Stop nodes gracefully with `enclave nodes down`.
2. If downtime > exit delay, call `deregisterOperator` and reclaim collateral later.
3. Otherwise, keep tickets + license bonded but announce maintenance to aggregators so committee
   planners know to expect fewer submissions.
4. After maintenance, double-check config secrets and run `enclave nodes up`.

## Scenario 5 — Expanding to multiple chains

1. Duplicate the `chains` section inside `enclave.config.yaml` with new RPC URLs and contract
   addresses.
2. Allocate fresh ticket balances per chain (each registry is independent).
3. Run separate CLI supervisors or containers to keep blast radius small.
4. Use labeling/metrics to distinguish logs per chain.

Adapt these scenarios to your internal runbooks and share improvements via PRs so the community keeps
leveling up—just like the best competitor docs do.

## Lifecycle quick reference

| State | How you get here | How to leave |
| --- | --- | --- |
| Unbonded | Fresh wallet, zero ENCL locked | `bondLicense(amount)` |
| Licensed | Bonded ≥ required amount but not registered | `registerOperator()` |
| Registered | In the IMT but maybe inactive | `addTicketBalance()` (become active) or `deregisterOperator()` |
| Active | Registered + ticket + bond minimums met | `removeTicketBalance()` / `unbondLicense()` (drops to inactive) |
| Inactive | Registered but missing tickets/bond | Top up tickets/bond |
| ExitPending | `deregisterOperator()` called | `claimExits()` (finish) or `registerOperator()` (cancel) |

Use this alongside the state diagram in the overview page when debugging transitions.

## Troubleshooting cheat sheet

| Symptom | Checks | Fix |
| --- | --- | --- |
| Node fails to start | `enclave config show`, RPC connectivity, wallet + password presence | Re-run `enclave init`, reset secrets, verify WebSocket URL |
| No events flowing | RPC health, `enclave nodes ps`, firewall rules | Switch RPC, restart CLI supervisor, ensure websocket endpoint |
| Keyshare generation fails | Ensure you were actually selected, disk space, permissions on data dir | Restart node after clearing corrupt job folder, re-import secrets |
| Decryption stalls | Confirm `CiphertextOutputPublished` fired, job still active, secret share available | Replay event logs, rehydrate job metadata, escalate before appeal window closes |

## Monitoring commands

```bash
enclave nodes ps
enclave jobs list
enclave jobs status <e3_id>
cast call $BONDING "isActive(address)" $OPERATOR
```

Pipe these into your favorite exporter or watch scripts so you notice issues before slashing
proposals land.
